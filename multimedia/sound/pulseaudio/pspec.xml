<?xml version="1.0" ?>
<!DOCTYPE PISI SYSTEM "http://www.pardus.org.tr/projeler/pisi/pisi-spec.dtd">
<PISI>
    <Source>
        <Name>pulseaudio</Name>
        <Homepage>http://pulseaudio.org/</Homepage>
        <Packager>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Packager>
        <License>LGPLv2</License>
        <License>GPLv2</License>
        <IsA>app:console</IsA>
        <Summary>A networked sound server with an advanced plugin system</Summary>
        <Description>pulseaudio is a sound server for POSIX and Win32 systems. It allows you to do advanced operations on your sound data as it passes between your application and your hardware.</Description>
        <Archive sha1sum="0309c97f7e0812e243c1bb80a4b74dc26369ac22" type="targz">http://0pointer.de/lennart/projects/pulseaudio/pulseaudio-0.9.21.tar.gz</Archive>
        <BuildDependencies>
            <Dependency>gtk2</Dependency>
            <Dependency>lirc</Dependency>
            <Dependency>gconf</Dependency>
            <Dependency>avahi</Dependency>
            <Dependency>bluez</Dependency>
            <Dependency>speex</Dependency>
            <Dependency>libtdb</Dependency>
            <Dependency>libcap</Dependency>
            <Dependency>doxygen</Dependency>
            <Dependency>libXtst</Dependency>
            <Dependency>alsa-lib</Dependency>
            <Dependency>xcb-proto</Dependency>
            <Dependency>libsndfile</Dependency>
            <Dependency>libasyncns</Dependency>
            <Dependency>libatomic_ops</Dependency>
            <Dependency>libsamplerate</Dependency>
            <Dependency>jack-audio-connection-kit</Dependency>
        </BuildDependencies>
        <Patches>
            <!-- Change default resampling method to speex-float-0 for reducing
            high CPU load of Pulseaudio: https://qa.mandriva.com/show_bug.cgi?id=36084 -->
            <Patch level="1">mandriva/Change-the-default-resample-method-to-speex-float-0.patch</Patch>

            <!-- Hack start-pulseaudio-x11 script to check /etc/conf.d/pulseaudio -->
            <Patch level="1">mandriva/Customise-startup-so-we-can-easily-disable-PA.patch</Patch>

            <Patch level="1">change-default-buffering-fragments.patch</Patch>

            <!-- Change default buffering and lazy load KDE3 theme sounds -->
            <Patch level="1">load-sample-dir-lazy.patch</Patch>

            <!-- Disable flat volumes -->
            <Patch level="1">daemon-conf-disable-flat-volumes.patch</Patch>

            <!-- Upstream patches -->
            <Patch level="1">fedora/0001-dbus-remove-filter-functions-only-if-they-were-actua.patch</Patch>
            <Patch level="1">fedora/0002-native-fix-request-counter-miscalculations.patch</Patch>
            <Patch level="1">fedora/0003-core-make-sure-we-always-return-a-valid-memblock-in-.patch</Patch>
            <Patch level="1">fedora/0004-bluetooth-destruct-stream-only-if-it-is-not-already-.patch</Patch>
            <Patch level="1">fedora/0005-bluetooth-don-t-hit-an-assert-if-latency-is-queried-.patch</Patch>
            <Patch level="1">fedora/0006-client-detect-forking-in-sample-cache-API-too.patch</Patch>
            <Patch level="1">fedora/0007-client-verify-connection-state-in-pa_stream_connect_.patch</Patch>
            <Patch level="1">fedora/0008-udev-don-t-forget-to-unref-devices-we-are-not-intere.patch</Patch>
            <Patch level="1">fedora/0009-once-make-once-related-variables-volatile.patch</Patch>
            <Patch level="1">fedora/0010-bluetooth-fix-invalid-memory-access.patch</Patch>
            <Patch level="1">fedora/0011-log-add-an-easy-way-to-disable-log-rate-limiting.patch</Patch>
            <Patch level="1">fedora/0012-udev-make-sure-we-get-events-only-for-sound-devices.patch</Patch>
            <Patch level="1">fedora/0013-alsa-ignore-volume-changes-from-the-hw-if-we-are-not.patch</Patch>
            <Patch level="1">fedora/0014-cpu-check-for-CMOV-flag-before-using-this-intsructio.patch</Patch>
            <Patch level="1">fedora/0015-alsa-cover-Input-Source-Int-Mic.patch</Patch>
            <Patch level="1">fedora/0016-alsa-Cover-the-Int-Mic-Boost-element.patch</Patch>
            <Patch level="1">fedora/0017-udev-handle-sound-cards-with-both-modem-and-audio-pr.patch</Patch>
            <Patch level="1">fedora/0018-udev-rework-modem-detection-a-bit.patch</Patch>
            <Patch level="1">fedora/0019-daemon-first-take-name-on-the-bus-then-return-in-sta.patch</Patch>
            <Patch level="1">fedora/0020-alsa-cover-bass-boost-mixer-element.patch</Patch>
            <Patch level="1">fedora/0021-Mark-shared-variables-as-volatile.patch</Patch>
            <Patch level="1">fedora/0022-udev-use-ID_MODEL_ENC-instead-of-ID_MODEL-if-it-is-s.patch</Patch>
            <Patch level="1">fedora/0023-pacat-allow-configuration-of-latency-in-msec.patch</Patch>
            <Patch level="1">fedora/0024-client-implement-PULSE_LATENCY_MSEC.patch</Patch>
            <Patch level="1">fedora/0025-client-include-dolby-channel-names-in-comments.patch</Patch>
            <Patch level="1">fedora/0026-alsa-add-profile-set-for-M-Audio-FastTrack-Pro-USB.patch</Patch>
            <Patch level="1">fedora/0027-threaded-mainloop-Properly-initialise-m-n_waiting_fo.patch</Patch>
            <Patch level="1">fedora/0028-udev-Use-SOUND_CLASS-instead-of-SOUND_FORM_FACTOR-wh.patch</Patch>
            <Patch level="1">fedora/0029-More-src-pulsecore-cpu-arm.c-FTBFS-fixes.patch</Patch>
            <Patch level="1">fedora/0030-Fix-the-following-warnings-which-now-cause-buildd-fa.patch</Patch>
            <Patch level="1">fedora/0031-libpulse-Store-pa_stream-pointers-to-hashmaps-instea.patch</Patch>
            <Patch level="1">fedora/0032-native-rework-handling-of-seeks-that-depend-on-varia.patch</Patch>
            <Patch level="1">fedora/0033-core-Fix-macro-typo-PA_SINK_IS_LINKED-PA_SINK_INPUT_.patch</Patch>
            <Patch level="1">fedora/0034-alsa-cover-Desktop-Speaker-mixer-elements.patch</Patch>
            <Patch level="1">fedora/0035-alsa-cover-Shared-Mic-Line-in-Analog-Source.patch</Patch>
            <Patch level="1">fedora/0036-alsa-cover-Internal-Mic-elements.patch</Patch>
            <Patch level="1">fedora/0037-alsa-use-default-output-port-names.patch</Patch>
            <Patch level="1">fedora/0038-build-sys-add-gobject-to-build-dependencies.patch</Patch>
            <Patch level="1">fedora/0039-padsp-emulate-dev-audio-too.patch</Patch>
            <Patch level="1">fedora/0040-dbus-first-restart-timer-then-dispatch-it.patch</Patch>
            <Patch level="1">fedora/0041-fdsem-be-more-verbose-when-reading-from-eventfd-fail.patch</Patch>
            <Patch level="1">fedora/0042-pacat-always-fully-fulfill-write-requests.patch</Patch>
            <Patch level="1">fedora/0043-pacmd-store-away-fd-type.patch</Patch>
            <Patch level="1">fedora/0044-pacmd-don-t-enter-busy-loop-when-reading-from-stdin-.patch</Patch>
            <Patch level="1">fedora/0045-shm-don-t-complain-about-missing-SHM-segments.patch</Patch>
            <Patch level="1">fedora/0046-vala-fix-definition-of-INVALID_INDEX.patch</Patch>
            <Patch level="1">fedora/0047-vala-fix-definition-of-the-GLib-mainloop-adapter.patch</Patch>
            <Patch level="1">fedora/0048-Add-missing-profile-and-alsa-mixer-paths-to-src-Make.patch</Patch>
            <Patch level="1">fedora/0049-channelmap-Use-Subwoofer-as-pretty-name-for-LFE.patch</Patch>
            <Patch level="1">fedora/0050-vala-fix-wrapping-of-port-setting-calls.patch</Patch>
            <Patch level="1">fedora/0051-proplist-explicitly-mention-a-role-test.patch</Patch>
            <Patch level="1">fedora/0052-stream-restore-be-a-little-bit-more-verbose-why-we-d.patch</Patch>
            <Patch level="1">fedora/0053-sample-cache-use-the-sample-name-as-unmodified-fallb.patch</Patch>
            <Patch level="1">fedora/0054-scache-when-playing-a-sample-from-the-cache-make-sur.patch</Patch>
            <Patch level="1">fedora/0055-pacat-pass-buffer_attr-to-recording-streams-too.patch</Patch>
            <Patch level="1">fedora/0056-suspend-on-idle-resume-audio-device-even-for-initial.patch</Patch>
            <Patch level="1">fedora/0057-native-improve-logging-for-buffer_attrs.patch</Patch>
            <Patch level="1">fedora/0058-alsa-util-strip-spaces-from-ALSA-card-pcm-names.patch</Patch>
            <Patch level="1">fedora/0059-alsa-reset-max_rewind-max_request-while-suspending.patch</Patch>
            <Patch level="1">fedora/0060-core-util-introduce-generic-function-pa_strip.patch</Patch>
            <Patch level="1">fedora/0061-esd-simple-use-pa_memblockq_pop_missing.patch</Patch>
            <Patch level="1">fedora/0062-core-rework-how-stream-volumes-affect-sink-volumes.patch</Patch>

            <Patch level="1">mandriva/0162-core-util-ensure-that-we-chmod-only-the-dir-we-ourse.patch</Patch>
            <Patch level="1">mandriva/0163-Handle-Digital-Mic-as-an-Input-Source.patch</Patch>
            <!--<Patch level="1">mandriva/0164-Fix-crash-on-jack-server-shutdown.patch</Patch>-->
            <Patch level="1">mandriva/0165-intended-roles-Do-not-pick-monitor-sources-when-doin.patch</Patch>

            <Patch level="1">0200-properly-handle-asyncns-failures.patch</Patch>

        </Patches>
    </Source>

    <Package>
        <Name>pulseaudio-docs</Name>
        <Summary>doxygen generated API documentation for PulseAudio</Summary>
        <Files>
            <Path fileType="doc">/usr/share/doc/pulseaudio/html</Path>
        </Files>
    </Package>

    <Package>
        <Name>pulseaudio</Name>
        <RuntimeDependencies>
            <!-- This is a weakref, not strictly needed during runtime
            <Dependency>gtk2</Dependency>
            -->
            <Dependency>lirc</Dependency>
            <Dependency>avahi</Dependency>
            <Dependency>bluez</Dependency>
            <Dependency>speex</Dependency>
            <Dependency>libcap</Dependency>
            <Dependency>libtdb</Dependency>
            <Dependency>libXtst</Dependency>
            <Dependency>alsa-lib</Dependency>
            <Dependency>libasyncns</Dependency>
            <Dependency>libsndfile</Dependency>
            <Dependency>libsamplerate</Dependency>
        </RuntimeDependencies>
        <Replaces>
            <Package>pulseaudio-bluetooth</Package>
        </Replaces>
        <Files>
            <Path fileType="config">/etc/conf.d</Path>
            <Path fileType="config">/etc/pulse</Path>
            <Path fileType="library">/usr/lib</Path>
            <Path fileType="header">/usr/include</Path>
            <Path fileType="data">/etc/xdg/autostart</Path>
            <Path fileType="data">/lib/udev/rules.d</Path>
            <Path fileType="data">/usr/lib/pkgconfig</Path>
            <Path fileType="data">/usr/share</Path>
            <Path fileType="data">/var/lib/pulse</Path>
            <Path fileType="data">/var</Path>
            <Path fileType="executable">/usr/bin</Path>
            <Path fileType="executable">/usr/lib/pm-utils/sleep.d</Path>
            <Path fileType="executable">/usr/libexec/pulse/proximity-helper</Path>
        </Files>
        <AdditionalFiles>
            <AdditionalFile owner="root" permission="0755" target="/usr/lib/pm-utils/sleep.d/02PulseAudio">02PulseAudio</AdditionalFile>
            <AdditionalFile owner="root" permission="0644" target="/etc/conf.d/pulseaudio">pulseaudio.conf</AdditionalFile>
        </AdditionalFiles>
        <Provides>
            <!-- For ownerships and permissions -->
            <COMAR script="package.py">System.Package</COMAR>
        </Provides>
    </Package>

    <Package>
        <Name>pulseaudio-gconf</Name>
        <Summary>GConf configuration backend for the PulseAudio sound server</Summary>
        <RuntimeDependencies>
            <Dependency>pulseaudio</Dependency>
            <Dependency>gconf</Dependency>
        </RuntimeDependencies>
        <Files>
            <Path fileType="library">/usr/lib/pulse-0.9.21/modules/module-gconf.so</Path>
            <Path fileType="executable">/usr/libexec/pulse/gconf-helper</Path>
        </Files>
    </Package>

    <Package>
        <Name>pulseaudio-jack</Name>
        <Summary>JACK sink and source modules for the PulseAudio sound server</Summary>
        <RuntimeDependencies>
            <Dependency>pulseaudio</Dependency>
            <Dependency>jack-audio-connection-kit</Dependency>
        </RuntimeDependencies>
        <Files>
            <Path fileType="library">/usr/lib/pulse-0.9.21/modules/module-jack-sink.so</Path>
            <Path fileType="library">/usr/lib/pulse-0.9.21/modules/module-jack-source.so</Path>
        </Files>
    </Package>

    <History>
        <Update release="21">
            <Date>2010-05-25</Date>
            <Version>0.9.21</Version>
            <Comment>Drop gtk2 runtime dependency.</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="20">
            <Date>2010-03-31</Date>
            <Version>0.9.21</Version>
            <Comment>Add more patches, revert an upstream-reverted one, add libcap dependency.</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="19">
            <Date>2010-03-10</Date>
            <Version>0.9.21</Version>
            <Comment>Version bump</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="18">
            <Date>2009-10-26</Date>
            <Version>0.9.15</Version>
            <Comment>Backport 5 patches from upstream which fix aborts with skype 2.1.</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="17">
            <Date>2009-08-03</Date>
            <Version>0.9.15</Version>
            <Comment>udev-extras is now merged into udev.</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="16" type="security">
            <Date>2009-07-20</Date>
            <Version>0.9.15</Version>
            <Comment>Remove exploitable LD_BIND_NOW hack (CVE-2009-1894) (#10490).</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="15">
            <Date>2009-07-10</Date>
            <Version>0.9.15</Version>
            <Comment>Add hack for squeezing old configs, enable tsched, add 2 ubuntu patches.</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="14">
            <Date>2009-06-09</Date>
            <Version>0.9.15</Version>
            <Comment>Sync recommended upstream patches for the 0.9.15 branch.</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="13">
            <Date>2009-06-07</Date>
            <Version>0.9.15</Version>
            <Comment>Grab some upstream fixes which includes the fix for the muting problem (#9902).</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="12">
            <Date>2009-04-26</Date>
            <Version>0.9.15</Version>
            <Comment>
                - Version bump to the latest stable release,
                - Reorganize dependencies and paths,
                - Switch to speex-float-0 resampling method for reducing CPU load,
                - Merge bluetooth modules into the main package,
                - Drop jack-audio and gconf runtime dependencies from pulseaudio,
                - Add COMAR service for system-wide PulseAudio support,
                - Split doxygen API documentations,
                - Disable timer based scheduling by default for not breaking buggy ALSA drivers.
            </Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="11">
            <Date>2009-02-16</Date>
            <Version>0.9.15_rc2</Version>
            <Comment>
                - Version bump to the latest testing release,
                - Add libasyncns dependency,
                - Disable timer based scheduling as it's buggy,
                - Disable autospawning as it causes problems.
            </Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="10">
            <Date>2008-12-22</Date>
            <Version>0.9.13</Version>
            <Comment>Add pm-utils hook to suspend an active source/sink.</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="9">
            <Date>2008-10-06</Date>
            <Version>0.9.13</Version>
            <Comment>
                Version bump to 0.9.13. This is mostly a bugfix release.
                However, it contains some minor API additions and new
                Bluetooth support (experimental for now) contributed by
                Google Summer Student João Paulo Rechi Vita.
            </Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="8">
            <Date>2008-09-10</Date>
            <Version>0.9.12</Version>
            <Comment>Version bump with a post-release patch.</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="7">
            <Date>2008-07-24</Date>
            <Version>0.9.11</Version>
            <Comment>Version bump</Comment>
            <Name>S.Çağlar Onur</Name>
            <Email>caglar@pardus.org.tr</Email>
        </Update>
        <Update release="6">
            <Date>2008-04-10</Date>
            <Version>0.9.10</Version>
            <Comment>Version bump</Comment>
            <Name>S.Çağlar Onur</Name>
            <Email>caglar@pardus.org.tr</Email>
        </Update>
        <Update release="5">
            <Date>2008-03-13</Date>
            <Version>0.9.9</Version>
            <Comment>Version bump</Comment>
            <Name>S.Çağlar Onur</Name>
            <Email>caglar@pardus.org.tr</Email>
        </Update>
        <Update release="4">
            <Date>2007-12-27</Date>
            <Version>0.9.8</Version>
            <Comment>Version bump</Comment>
            <Name>S.Çağlar Onur</Name>
            <Email>caglar@pardus.org.tr</Email>
        </Update>
        <Update release="3">
            <Date>2007-05-28</Date>
            <Version>0.9.6</Version>
            <Comment>Add avahi deps.</Comment>
            <Name>Ertuğrul Erata</Name>
            <Email>ertugrulerata@gmail.com</Email>
        </Update>
        <Update release="2">
            <Date>2007-05-11</Date>
            <Version>0.9.5</Version>
            <Comment>Add avahi deps.</Comment>
            <Name>Ertuğrul Erata</Name>
            <Email>ertugrulerata@gmail.com</Email>
        </Update>
         <Update release="1">
            <Date>2007-03-21</Date>
            <Version>0.9.5</Version>
            <Comment>First release.</Comment>
            <Name>Ertuğrul Erata</Name>
            <Email>ertugrulerata@gmail.com</Email>
        </Update>
    </History>
</PISI>
