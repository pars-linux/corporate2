Index: linux-2.6.30/drivers/scsi/gdth.c
===================================================================
--- linux-2.6.30.orig/drivers/scsi/gdth.c
+++ linux-2.6.30/drivers/scsi/gdth.c
@@ -2900,7 +2900,7 @@ static int gdth_read_event(gdth_ha_str *
         eindex = handle;
     estr->event_source = 0;
 
-    if (eindex >= MAX_EVENTS) {
+    if (eindex < 0 || eindex >= MAX_EVENTS) {
         spin_unlock_irqrestore(&ha->smp_lock, flags);
         return eindex;
     }
