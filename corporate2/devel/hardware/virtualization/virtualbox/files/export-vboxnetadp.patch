Index: VirtualBox-3.0.4_OSE/src/VBox/HostDrivers/linux/export_modules
===================================================================
--- VirtualBox-3.0.4_OSE.orig/src/VBox/HostDrivers/linux/export_modules
+++ VirtualBox-3.0.4_OSE/src/VBox/HostDrivers/linux/export_modules
@@ -36,6 +36,7 @@ PATH_ROOT="`cd \`dirname $0\`/../../../.
 PATH_LINUX="$PATH_ROOT/src/VBox/HostDrivers/linux"
 PATH_VBOXDRV="$PATH_ROOT/src/VBox/HostDrivers/Support"
 PATH_VBOXNET="$PATH_ROOT/src/VBox/HostDrivers/VBoxNetFlt"
+PATH_VBOXNETADP="$PATH_ROOT/src/VBox/HostDrivers/VBoxNetAdp"
 
 VBOX_VERSION_MAJOR=`sed -e "s/^ *VBOX_VERSION_MAJOR *= \+\([0-9]\+\)/\1/;t;d" $PATH_ROOT/Config.kmk`
 VBOX_VERSION_MINOR=`sed -e "s/^ *VBOX_VERSION_MINOR *= \+\([0-9]\+\)/\1/;t;d" $PATH_ROOT/Config.kmk`
@@ -44,6 +45,7 @@ VBOX_VERSION_STRING=$VBOX_VERSION_MAJOR.
 
 . $PATH_VBOXDRV/linux/files_vboxdrv
 . $PATH_VBOXNET/linux/files_vboxnetflt
+. $PATH_VBOXNETADP/linux/files_vboxnetadp
 
 # Temporary path for creating the modules, will be removed later
 mkdir $PATH_TMP || exit 1
@@ -90,6 +92,20 @@ else
     sed -e "s;-DVBOX_WITH_HARDENING;;g" < $PATH_VBOXNET/linux/Makefile > $PATH_TMP/vboxnetflt/Makefile
 fi
 
+# vboxnetadp (VirtualBox network adapter kernel module)
+mkdir $PATH_TMP/vboxnetadp || exit 1
+for f in $VBOX_VBOXNETADP_SOURCES; do
+    install -D -m 0644 `echo $f|cut -d'=' -f1` "$PATH_TMP/vboxnetadp/`echo $f|cut -d'>' -f2`"
+done
+sed -e "s;_VERSION_;$VBOX_VERSION_STRING;g" < $PATH_LINUX/build_in_tmp > $PATH_TMP/vboxnetadp/build_in_tmp
+chmod 0755 $PATH_TMP/vboxnetadp/build_in_tmp
+sed -e "s;_VERSION_;$VBOX_VERSION_STRING;g" < $PATH_VBOXNETADP/linux/dkms.conf > $PATH_TMP/vboxnetadp/dkms.conf
+if [ -n "$VBOX_WITH_HARDENING" ]; then
+    cat                                   $PATH_VBOXNETADP/linux/Makefile > $PATH_TMP/vboxnetadp/Makefile
+else
+    sed -e "s;-DVBOX_WITH_HARDENING;;g" < $PATH_VBOXNETADP/linux/Makefile > $PATH_TMP/vboxnetadp/Makefile
+fi
+
 install -D -m 0644 $PATH_LINUX/Makefile $PATH_TMP/Makefile
 
 # Only temporary, omit from archive
