From 68ff5e177bea8ab39661c360895bba5c8e2621e7 Mon Sep 17 00:00:00 2001
From: mete <mete@26e1f6f6-46e4-0310-a0b7-a8a415fd4c45>
Date: Fri, 4 Feb 2011 09:30:53 +0000
Subject: [PATCH] Fixes if storage backend doesnt throw exception

git-svn-id: https://svn.pardus.org.tr/uludag/trunk/yali@35896 26e1f6f6-46e4-0310-a0b7-a8a415fd4c45
---
 yali/storage/partitioning.py |   45 ++++++++++++++++++++++-------------------
 1 files changed, 24 insertions(+), 21 deletions(-)

diff --git a/yali/storage/partitioning.py b/yali/storage/partitioning.py
index 99b843f..93a973e 100644
--- a/yali/storage/partitioning.py
+++ b/yali/storage/partitioning.py
@@ -1684,25 +1684,28 @@ def doAutoPartition(storage):
         ctx.logger.warning(msg)
         return None
 
-    # sanity check the collection of devices
-    #ctx.logger.warning("not sanity checking storage config because I don't know how yet")
-    # now do a full check of the requests
-    (errors, warnings) = storage.sanityCheck()
-    if warnings:
-        for warning in warnings:
-            ctx.logger.warning(warning)
-
-    if errors:
-        errortxt = "\n".join(errors)
-        extra = _("\n\nPress 'OK' to exit the installer.")
-        ctx.interface.messageWindow(_("Automatic Partitioning Errors"),
-                                    _("The following errors occurred with your "
-                                      "partitioning:\n\n%(errortxt)s\n\n"
-                                      "This can happen if there is not enough "
-                                      "space on your hard drive(s) for the "
-                                      "installation. %(extra)s") %
-                                    {'errortxt': errortxt, 'extra': extra},
-                                    type='error')
+    else:
+        # sanity check the collection of devices
+        #ctx.logger.warning("not sanity checking storage config because I don't know how yet")
+        # now do a full check of the requests
+        (errors, warnings) = storage.sanityCheck()
+        if warnings:
+            for warning in warnings:
+                ctx.logger.warning(warning)
+
+        if errors:
+            errortxt = "\n".join(errors)
+            extra = _("\n\nPress 'OK' to exit the installer.")
+            ctx.interface.messageWindow(_("Automatic Partitioning Errors"),
+                                        _("The following errors occurred with your "
+                                          "partitioning:\n\n%(errortxt)s\n\n"
+                                          "This can happen if there is not enough "
+                                          "space on your hard drive(s) for the "
+                                          "installation. %(extra)s") %
+                                        {'errortxt': errortxt, 'extra': extra},
+                                        type='error')
 
-        storage.reset()
-        return None
+            storage.reset()
+            return None
+
+        return True
-- 
1.7.3.4

