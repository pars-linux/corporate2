diff -Nuar php-5.2.14.orig//main/php_variables.c php-5.2.14/main/php_variables.c
--- php-5.2.14.orig//main/php_variables.c	2012-02-09 15:04:14.914000030 +0200
+++ php-5.2.14/main/php_variables.c	2012-02-09 15:05:51.573999582 +0200
@@ -194,6 +194,9 @@
 					    MAKE_STD_ZVAL(gpc_element);
 					    array_init(gpc_element);
 					    zend_symtable_update(symtable1, escaped_index, index_len + 1, &gpc_element, sizeof(zval *), (void **) &gpc_element_p);
+                    } else {
+                        efree(var_orig);
+                        return;
                     }
 				}
 				if (index != escaped_index) {
